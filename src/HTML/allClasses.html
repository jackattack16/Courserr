<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Courserr - Browse and discover courses at Ames High School">
  <title>Courserr - Course Catalog</title>

  <link rel="icon" href="../Images/logo.png">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet">

  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

  <link rel="stylesheet" href="../Style/style.css">
  <link rel="stylesheet" href="../Style/sidebar.css">
  <link rel="stylesheet" href="../Style/classColours.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script type="importmap">
    {
      "imports": {
        "@material/web/": "https://esm.run/@material/web/"
      }
    }
  </script>
  <script src="../Javascript/Class.js"></script>
  <script src="../Javascript/ClassInstantiation.js"></script>

  <script type="module">
    import '@material/web/all.js';
    import { styles as typescaleStyles } from '@material/web/typography/md-typescale-styles.js';

    document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
  </script>

  <style>
    .material-symbols-rounded {
      font-variation-settings:
        'FILL' 1,
        'wght' 500,
        'GRAD' 200,
        'opsz' 48;
      transition: font-variation-settings 0.5s ease;
    }

    .no-fill {
      font-variation-settings:
        'FILL' 0,
        'wght' 500,
        'GRAD' 200,
        'opsz' 48;
    }

    .unfilled {
      font-variation-settings:
        'FILL' 1,
        'wght' 500,
        'GRAD' -25,
        'opsz' 48;
      font-size: 50vh;
    }

    @media (max-width:768px) {
    }

    .codePic {
      height: 4vw;
      margin-left: 0.5vw;
      top: 92vh;
      position: absolute;
    }
  .class-icon {
    font-family: 'Material Symbols Rounded';
    font-weight: normal;
    font-style: normal;
    font-size: max(1.75vw, 1.75vh);
    line-height: 1;
    letter-spacing: normal;
    text-transform: none;
    display: inline-block;
    white-space: nowrap;
    word-wrap: normal;
    direction: ltr;
    -moz-font-feature-settings: 'liga';
    -moz-osx-font-smoothing: grayscale;
  }

    md-filter-chip {
      transition: background-color 1.5s ease;
    }

    md-sys-color {
      transition: outline-color 1.5s ease;
    }

  </style>

  <style>
    @media (min-width: 768px) and (max-width: 1024px) {
      .class-grid {
        grid-template-columns: repeat(3, calc(80vw / 3)); /* Two columns on tablet */
        padding: 2.5vw;
      }
    }
  </style>

</head>

<body onload="load();" style="background-color: var(--light-bg)" id="body">
  <a href="#main-content" class="skip-link">Skip to main content</a>
  <md-fab label="Add Your Input On Classes" size="large" class="fab"
    onclick="window.open('https://docs.google.com/forms/d/e/1FAIpQLSdzS9RgGFL1E0A3C-tiwaXu3Zx13y2GUMDnRKxamePGoYw8-w/viewform?usp=header', '_blank').focus()"
    aria-label="Add your input on classes - opens feedback form">
    <md-icon class="material-symbols-rounded" slot="icon" aria-hidden="true">add</md-icon>
  </md-fab>


  <div class="container" id="fullHeightDiv">
    <button class="material-symbols-rounded menuMobile openMenu mobileClose" style="font-size: 5vh; transition: opacity 0.25s ease, transform 0.5s ease;" id="lines" onclick="openClose(true)" aria-label="Open navigation menu" aria-expanded="false" aria-controls="sidebar">menu</button>
    <button class="material-symbols-rounded menuMobile mobileClose" style="font-size: 5vh; transition: opacity 0.25s ease, transform 0.5s ease;" id="exes" onclick="openClose(false)" aria-label="Close navigation menu" aria-expanded="true" aria-controls="sidebar">close</button>
    <nav class="sidebar" id="sidebar" style="background-color: var(--light-mode-bg)" aria-label="Main navigation">
      <button class="sidebarItem mobileClose" onclick="openClose(false)" id="mobileClose" style="padding-left: 7vh;" aria-label="Close menu">
        <span>Close</span>
      </button>
      <button class="sidebarItem" onclick="window.location.href = './allClasses.html';">
        <span class="material-symbols-rounded sidebar-icon" aria-hidden="true">flood</span><span>Home</span>
      </button>
      <button class="sidebarItem" onclick="window.open('https://docs.google.com/document/d/1n4HRkpug7Vh7ZYWIeSQcKXRjLHPDzmVj/edit#heading=h.gjdgxs');">
        <span class="material-symbols-rounded sidebar-icon" aria-hidden="true">menu_book</span><span>Handbook</span>
      </button>
      <button class="sidebarItem" onclick="window.open('https://ameshighathletics.org/activities/?per_page=12&page=1', '_blank').focus();">
        <span class="material-symbols-rounded sidebar-icon no-fill" aria-hidden="true">groups</span><span>Clubs & Activities</span>
      </button>
      <button class="sidebarItem" onclick="window.open('https://docs.google.com/forms/d/e/1FAIpQLSdDH42uqIz3Om26jL_gGW5gQYDMwOj298VUGsPA_PfuC-56Dw/viewform?usp=publish-editor', '_blank').focus()">
        <span class="material-symbols-rounded sidebar-icon" aria-hidden="true">bug_report</span><span>Bugs/Issues</span>
      </button>
      <button class="sidebarItem" onclick="window.location.href = '../index.html'">
        <span class="material-symbols-rounded sidebar-icon" aria-hidden="true">help</span><span>Help</span>
      </button>
      <button class="sidebarItem" onclick="window.open('https://github.com/jackattack16/Courserr').focus()">
        <img src="../Images/github-mark.png" class="sidebar-icon" alt="GitHub logo"><span>Contribute</span>
      </button>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
      <header class="header" style="background-color: var(--light-mode-bg)" id="header">
        <h1 class="title">
          <strong>Course<i>rr</i></strong>
        </h1>
        <div class="search-container" id="search-container">
          <div class="search-box" focusout="searchCourses()">
            <label for="searchInput" class="visually-hidden">Search courses</label>
            <span class="material-symbols-rounded search-icon" aria-hidden="true">search</span>
            <input type="search" id="searchInput" placeholder="Search courses..." onkeyup="searchCourses()"
              autocomplete="off" aria-label="Search courses">
            <button class="material-symbols-rounded clear-search" id="clearSearch" onclick="clearSearch()"
              style="display: none;" aria-label="Clear search" type="button">close</button>
          </div>
        </div>
        <div role="group" aria-label="Filter by subject">
          <md-chip-set class="filterArea" role="listbox" aria-label="Subject filters">
            <!-- Filter chips will be generated dynamically from course data -->
          </md-chip-set>
        </div>
      </header>

      <!-- Filters Row -->
      <div class="filters" style="display: none" aria-hidden="true">
        <!--             <md-chip-set>
<md-assist-chip label="Filters" avatar>
    <img slot="icon" src="filterIcon.png">
  </md-assist-chip>
</md-chip-set>-->

      </div>

      <!-- Classes Grid -->
      <main id="main-content" aria-label="Course catalog">
        <div class="class-grid" id="classGrid">
          <div class="class-grid-col" id="col1"></div>
          <div class="class-grid-col" id="col2"></div>
          <div class="class-grid-col" id="col3"></div>
          <div class="class-grid-col" id="col4"></div>
        </div>
      </main>
      
    </div>
    </div>
  </div>
    </div>

  <div class="cookie-popup-holder" id="background-blur" role="dialog" aria-modal="true" aria-labelledby="cookie-title" aria-describedby="cookie-desc">
    <div id="cookie-banner" class="cookie-stuff" role="document">
      <h2 id="cookie-title" class="visually-hidden">Cookie preferences</h2>
      <p id="cookie-desc">We use cookies and anonymous analytics to improve the experience for everyone. We collect data like visited pages and commonly used features to understand how Courserr is used and make it better.
      </p>
      <div class="privacy-holder">
        <button onclick="acceptCookies()" class="accept" aria-label="Accept cookies">Accept</button>
        <button onclick="declineCookies()" class="decline" aria-label="Decline cookies">Decline</button>
      </div>
      <a href="privacy.html">Privacy Policy</a>
    </div>
  </div>
  <script src="../Javascript/cookies.js"></script>
  <script>
    function fav(element) {
      let fillValue;
      //alert(element.id);
      if (element.style.cssText.includes("1")) {
        fillValue = "'FILL' 0";  // If it's filled, switch to unfilled.
        bookmarks[bookmarks.indexOf(element.id)] = "";
      } else {
        fillValue = "'FILL' 1";  // If it's unfilled, switch to filled.
        bookmarks.push(element.id);
      }
      element.style.fontVariationSettings = fillValue;
      bookmarks = bookmarks.filter(item => item !== "");
      sessionStorage.setItem("bookmarks", bookmarks);
      //alert(sessionStorage.getItem("bookmarks"));
    }
    function modeChange(thing) {
      if (thing == "dark_mode") {
        document.getElementsByTagName('style')[0].innerHTML = "md-filter-chip { background-color: rgba(150, 150, 150, 0.5); --md-sys-color-outline:lightgrey;} .header {color: white;} .sidebar{color: white} .menuPic {filter: invert(100%)} .mode {filter: invert(100%)}";
        document.getElementById('body').style.backgroundColor = "var(--dark-bg)";
        document.getElementById('sidebar').style.backgroundColor = "var(--dark-mode-bg)";
        document.getElementById('header').style.backgroundColor = "var(--dark-mode-bg)";
      }
      if (thing.innerText == "light_mode") {
        thing.removeAttribute("onclick");
        thing.style.transition = "transform 1.5s ease, opacity 0.75s ease";
        thing.style.background = "none";
        thing.style.transform = "rotate(360deg)";
        thing.style.opacity = "0";
        document.getElementsByTagName('style')[0].innerHTML = "md-filter-chip { background-color: rgba(150, 150, 150, 0.5); --md-sys-color-outline:lightgrey;} .header {color: white;} .sidebar{color: white} .menuPic {filter: invert(100%)} .mode {filter: invert(100%)}";
        document.getElementById('body').style.backgroundColor = "var(--dark-bg)";
        document.getElementById('sidebar').style.backgroundColor = "var(--dark-mode-bg)";
        document.getElementById('header').style.backgroundColor = "var(--dark-mode-bg)";
        setTimeout(() => {

          thing.innerText = "dark_mode";
          thing.style.opacity = "1";
        }, 750);
        setTimeout(() => {

          thing.style.removeProperty("background");
          thing.style.removeProperty("opacity");
          thing.style.removeProperty("transform");
          thing.style.removeProperty("transition");
          thing.setAttribute("onclick", "modeChange(this)");
        }, 1500);
        //thing.innerText = "dark_mode";

        return;
      }
      if (thing.innerText == "dark_mode") {
        thing.removeAttribute("onclick");
        thing.style.transition = "transform 1.5s ease, opacity 0.75s ease";
        thing.style.background = "none";
        thing.style.transform = "rotate(360deg)";
        thing.style.opacity = "0";
        document.getElementsByTagName('style')[0].innerHTML = "md-filter-chip { background-color: white; }";
        document.getElementById('body').style.backgroundColor = "var(--light-bg)";
        document.getElementById('sidebar').style.backgroundColor = "var(--light-mode-bg)";
        document.getElementById('header').style.backgroundColor = "var(--light-mode-bg)";
        setTimeout(() => {

          thing.innerText = "light_mode";
          thing.style.opacity = "1";
        }, 750);
        setTimeout(() => {

          thing.style.removeProperty("background");
          thing.style.removeProperty("opacity");
          thing.style.removeProperty("transform");
          thing.style.removeProperty("transition");
          thing.setAttribute("onclick", "modeChange(this)");
        }, 1500);

        //thing.innerText = "light_mode";
      }

    }
    function openClose(closed) {
      let lines = document.getElementById('lines');
      let exes = document.getElementById('exes');
      let text = document.getElementById('mobileClose');
      let sidebar = document.getElementById('sidebar');
      
      // Only apply mobile slide behavior on screens smaller than 768px
      const isMobile = window.innerWidth <= 768;
      
      if (!isMobile) {
        // On desktop, sidebar should always stay visible - do nothing or just focus
        lines.focus();
        return;
      }
      
      if (closed) {
        exes.style.opacity = "1";
        exes.style.transform = "rotate(-90deg)"
        exes.style.zIndex = "1002";
        exes.setAttribute('aria-expanded', 'true');
        lines.style.opacity = "0";
        lines.style.transform = "rotate(90deg)";
        lines.style.zIndex = "1001";
        lines.setAttribute('aria-expanded', 'true');
        sidebar.classList.add('open');
        sidebar.setAttribute('aria-hidden', 'false');
        text.style.opacity = "1";
        exes.focus();

      } else {
        exes.style.opacity = "0";
        exes.style.transform = "rotate(0deg)"
        exes.style.zIndex = "1001";
        exes.setAttribute('aria-expanded', 'false');
        lines.style.opacity = "1";
        lines.style.transform = "rotate(0deg)";
        lines.style.zIndex = "1002";
        lines.setAttribute('aria-expanded', 'false');
        sidebar.classList.remove('open');
        sidebar.setAttribute('aria-hidden', 'true');
        text.style.opacity = "0";
        lines.focus();
      }

    }
    // Mobile search: replace title when search is active
    function initMobileSearchToggle() {
      const searchInput = document.getElementById('searchInput');
      const clearBtn = document.getElementById('clearSearch');
      const body = document.getElementById('body');
      if (!searchInput || !body) return;

      const activate = () => body.classList.add('mobile-search-active');
      const deactivate = () => {
        if (!searchInput.value.trim()) {
          body.classList.remove('mobile-search-active');
        }
      };

      searchInput.addEventListener('focus', activate);
      searchInput.addEventListener('input', () => {
        if (searchInput.value.trim()) activate();
        else deactivate();
      });
      searchInput.addEventListener('blur', () => setTimeout(deactivate, 150));

      if (clearBtn) {
        clearBtn.addEventListener('click', () => {
          body.classList.remove('mobile-search-active');
          searchInput.blur();
        });
      }
    } 

    document.addEventListener('DOMContentLoaded', initMobileSearchToggle);

  </script>
  <script src="../Javascript/script.js"></script>
</body>

</html>