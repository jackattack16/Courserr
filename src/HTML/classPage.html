<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Courserr - Course details and information">
  <title>Courserr - Course Details</title>

  <link rel="icon" href="../Images/logo.png">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet">

  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="stylesheet" href="../Style/style.css">
  <link rel="stylesheet" href="../Style/sidebar.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script type="importmap">
    {
      "imports": {
        "@material/web/": "https://esm.run/@material/web/"
      }
    }
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
  <script src="../Javascript/Class.js"></script>
  <script src="../Javascript/ClassInstantiation.js"></script>
  <script src="../Javascript/script.js"></script>
  <script src="../Javascript/cookies.js"></script>
  <script type="module">
    import '@material/web/all.js';
    import { styles as typescaleStyles } from '@material/web/typography/md-typescale-styles.js';

    document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
  </script>

  <style>
    md-suggestion-chip {
      background-color: rgba(255, 255, 255, 0.5);
    }

    /* Accessibility: Skip Link */
    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: #4285f4;
      color: white;
      padding: 8px 16px;
      z-index: 10000;
      text-decoration: none;
      font-weight: 600;
      border-radius: 0 0 4px 0;
      transition: top 0.2s ease;
    }
    .skip-link:focus {
      top: 0;
    }

    /* Accessibility: Focus States */
    :focus-visible {
      outline: 3px solid #4285f4;
      outline-offset: 2px;
    }

    /* Accessibility: Reduced Motion */
    @media (prefers-reduced-motion: reduce) {
      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
  </style>
  <style>
    .material-symbols-rounded {
      font-variation-settings:
        'FILL' 1,
        'wght' 500,
        'GRAD' 200,
        'opsz' 48;
      /*font-size: 4vh;*/
      transition: font-variation-settings 0.5s ease;
    }

    .unfilled {
      font-variation-settings:
        'FILL' 1,
        'wght' 500,
        'GRAD' -25,
        'opsz' 48;
      font-size: 50vh;
    }

    .no-fill {
      font-variation-settings:
        'FILL' 0,
        'wght' 500,
        'GRAD' 200,
        'opsz' 48;
    }

    @media (max-width:768px) {
      .material-symbols-rounded {
        font-size: 3vh;
      }
    }

    .codePic {
      height: 4vw;
      margin-left: 0.5vw;
      top: 92vh;
      position: absolute;
    }

    .header {
      height: 10vh;
    }

    md-suggestion-chip {
      transition: background-color 1.5s ease;
      background-color: white;
      color: black;
    }

    md-sys-color {
      transition: outline-color 1.5s ease;
    }
  </style>
  <style>
    /*body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            color: #fff;
            text-align: center;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }*/
    /*h1 {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }*/
    .chart-container {
      width: 80%;
      max-width: 800px;
      padding: 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    canvas {
      width: 100% !important;
      height: auto !important;
    }
  </style>
  <link rel="stylesheet" href="../Style/classPage.css">
</head>

<body class="classPage" onload="load();dothing()" style="background-color: var(--light-bg)" id="body">
  <a href="#main-content" class="skip-link">Skip to main content</a>
  <div class="container" id="fullHeightDiv">
    <button class="material-symbols-rounded menuMobile openMenu" id="lines" onclick="openClose(true)" aria-label="Open navigation menu" aria-expanded="false" aria-controls="sidebar">menu</button>
    <button class="material-symbols-rounded menuMobile closeMenu" id="exes" onclick="openClose(false)" aria-label="Close navigation menu" aria-expanded="true" aria-controls="sidebar">close</button>
    <button class="material-symbols-rounded mode" onclick="modeChange(this)" aria-label="Toggle dark mode">light_mode</button>
    <nav class="sidebar" id="sidebar" style="background-color: var(--light-mode-bg)" aria-label="Main navigation">
      <button class="sidebarItem mobileClose" onclick="openClose(false)" id="mobileClose" aria-label="Close menu">
        <span>Close</span>
      </button>
      <button class="sidebarItem" onclick="window.location.href = './allClasses.html';">
        <span class="material-symbols-rounded sidebar-icon" aria-hidden="true">flood</span>
        <span>Home</span>
      </button>
      <button class="sidebarItem" onclick="window.open('https://forms.gle/BzNknKsfrAYHzkww7', '_blank').focus();" aria-label="Rate this class - opens form">
        <span class="material-symbols-rounded sidebar-icon no-fill" aria-hidden="true">rate_review</span>
        <span>Rate class</span>
      </button>
      <button class="sidebarItem" onclick="window.open('https://docs.google.com/document/d/1n4HRkpug7Vh7ZYWIeSQcKXRjLHPDzmVj/edit#heading=h.gjdgxs');">
        <span class="material-symbols-rounded sidebar-icon" aria-hidden="true">menu_book</span>
        <span>Handbook</span>
      </button>
      <button class="sidebarItem" onclick="window.open('https://ameshighathletics.org/activities/?per_page=12&page=1', '_blank').focus();">
        <span class="material-symbols-rounded sidebar-icon" aria-hidden="true">groups</span>
        <span>Clubs & Activities</span>
      </button>
    </nav>

    <div class="main-content">
      <header class="header" style="background-color: var(--light-mode-bg)" id="header">
        <h1 class="title">
          <strong>Course<i>rr</i></strong>
        </h1>
      </header>
    </div>


    <main id="main-content" class="classPageInfoContainer" aria-label="Course details">
      <section class="classPageFullSpread" aria-label="Course overview">
        <div class="classPageHeaderRight">
          <div class="classPageClassName" id="classPageClassName">
            <h2 class="classPageName" id="className">Loading...</h2>
            <p class="classPageTeacher" id="teachers">Loading...</p>
          </div>
          <div class="classPageClassRateing" id="starRate" aria-label="Course rating">
            <!-- Star rating will be populated dynamically -->
          </div>
        </div>
        <div class="classPageHeaderLeft">
          <div class="classPageClassInfo">
            <div class="classPageClassPrereq">
              <h3>Prerequisites</h3>
              <ul>
                <li>Loading...</li>
              </ul>
            </div>
            <div class="classPageClassTags">
              <h3 class="tagsTitle">Tags</h3>
              <md-chip-set class="classPageClassTagsArea" role="list" aria-label="Course tags">
                <!-- Tags will be populated dynamically -->
              </md-chip-set>
            </div>
          </div>
          <div class="classPageClassInfo classPageBORDERS">
            <h3>Quick Hits</h3>
            <ul>
              <li>Loading...</li>
            </ul>
          </div>
        </div>

      </section>
      <div class="classPageDescriptionGraphContainer">
        <section class="classPageHalfSpread classPageClassDecription" aria-label="Course description">
          <h3>Description</h3>
          <p>Loading...</p>
        </section>
        <section class="classPageHalfSpread" aria-label="Course statistics">
          <canvas id="myChart" class='classPageGraphHalf' role="img" aria-label="Course statistics chart"></canvas>
        </section>
      </div>



    </main>


  </div>

  <div class="cookie-popup-holder" id="background-blur" role="dialog" aria-modal="true" aria-labelledby="cookie-title" aria-describedby="cookie-desc">
    <div id="cookie-banner" class="cookie-stuff" role="document">
      <h2 id="cookie-title" class="visually-hidden">Cookie preferences</h2>
      <p id="cookie-desc">We use cookies and anonymous analytics to improve the experience for everyone. We collect data like visited pages and commonly used features to understand how Courserr is used and make it better.</p>
      <div class="privacy-holder">
        <button onclick="acceptCookies()" class="accept" aria-label="Accept cookies">Accept</button>
        <button onclick="declineCookies()" class="decline" aria-label="Decline cookies">Decline</button>
      </div>
      <a href="privacy.html">Privacy Policy</a>
    </div>
  </div>


  <script>

    function modeChange(thing) {
      if (thing.innerText == "light_mode") {
        thing.removeAttribute("onclick");
        thing.style.transition = "transform 1.5s ease, opacity 0.75s ease";
        thing.style.background = "none";
        thing.style.transform = "rotate(360deg)";
        thing.style.opacity = "0";
        document.getElementsByTagName('style')[0].innerHTML = "md-suggestion-chip { background-color: rgba(150, 150, 150, 0.5); --md-sys-color-outline:lightgrey;} .header {color: white;} .sidebar{color: white} .menuPic {filter: invert(100%)} .mode {filter: invert(100%)}";
        document.getElementById('body').style.backgroundColor = "var(--dark-bg)";
        document.getElementById('sidebar').style.backgroundColor = "var(--dark-mode-bg)";
        document.getElementById('header').style.backgroundColor = "var(--dark-mode-bg)";
        setTimeout(() => {

          thing.innerText = "dark_mode";
          thing.style.opacity = "1";
        }, 750);
        setTimeout(() => {

          thing.style.removeProperty("background");
          thing.style.removeProperty("opacity");
          thing.style.removeProperty("transform");
          thing.style.removeProperty("transition");
          thing.setAttribute("onclick", "modeChange(this)");
        }, 1500);
        //thing.innerText = "dark_mode";

        return;
      }
      if (thing.innerText == "dark_mode") {
        thing.removeAttribute("onclick");
        thing.style.transition = "transform 1.5s ease, opacity 0.75s ease";
        thing.style.background = "none";
        thing.style.transform = "rotate(360deg)";
        thing.style.opacity = "0";
        document.getElementsByTagName('style')[0].innerHTML = "md-suggestion-chip { background-color: white; }";
        document.getElementById('body').style.backgroundColor = "var(--light-bg)";
        document.getElementById('sidebar').style.backgroundColor = "var(--light-mode-bg)";
        document.getElementById('header').style.backgroundColor = "var(--light-mode-bg)";
        setTimeout(() => {

          thing.innerText = "light_mode";
          thing.style.opacity = "1";
        }, 750);
        setTimeout(() => {

          thing.style.removeProperty("background");
          thing.style.removeProperty("opacity");
          thing.style.removeProperty("transform");
          thing.style.removeProperty("transition");
          thing.setAttribute("onclick", "modeChange(this)");
        }, 1500);

        //thing.innerText = "light_mode";
      }

    }
    function openClose(closed) {
      let lines = document.getElementById('lines');
      let exes = document.getElementById('exes');
      let text = document.getElementById('mobileClose');
      let sidebar = document.getElementById('sidebar');
      
      if (closed) {
        exes.style.opacity = "1";
        exes.style.transform = "rotate(-90deg)"
        exes.style.zIndex = "1002";
        exes.setAttribute('aria-expanded', 'true');
        lines.style.opacity = "0";
        lines.style.transform = "rotate(90deg)";
        lines.style.zIndex = "1001";
        lines.setAttribute('aria-expanded', 'true');
        sidebar.style.transform = "translateX(0vw)"
        sidebar.setAttribute('aria-hidden', 'false');
        text.style.opacity = "1";
        exes.focus();
      } else {
        exes.style.opacity = "0";
        exes.style.transform = "rotate(0deg)"
        exes.style.zIndex = "1001";
        exes.setAttribute('aria-expanded', 'false');
        lines.style.opacity = "1";
        lines.style.transform = "rotate(0deg)";
        lines.style.zIndex = "1002";
        lines.setAttribute('aria-expanded', 'false');
        sidebar.style.transform = "translateX(-40vw)"
        sidebar.setAttribute('aria-hidden', 'true');
        text.style.opacity = "0";
        lines.focus();
      }

    }

    function fill(element) {
      let fillValue;
      if (element.style.cssText.includes("1")) {
        fillValue = "'FILL' 0";  // If it's filled, switch to unfilled.
      } else {
        fillValue = "'FILL' 1";  // If it's unfilled, switch to filled.
      }
      element.style.fontVariationSettings = fillValue;
    }
  </script>
  <script src="../Javascript/loadClass.js"></script>
  <script>
    let course;
    window.onload = function () {
      console.log('JavaScript is running!');
      // Your onload logic
      const params = new URLSearchParams(window.location.search);
      let courseName = params.get('course');

      // If course parameter doesn't exist, try category parameter (for backward compatibility)
      if (!courseName) {
        courseName = params.get('category');
        if (courseName) {
          // Convert underscores back to spaces for category parameter
          courseName = courseName.replace(/_/g, ' ');
        }
      }

      console.log('Course name from URL: ' + courseName);
      console.log('displayCourseDetails function exists: ' + (typeof displayCourseDetails));
      console.log('courseMap exists: ' + (typeof courseMap !== 'undefined'));

      console.log('Course name from URL:', courseName);
      console.log('displayCourseDetails function exists:', typeof displayCourseDetails);
      console.log('courseMap exists:', typeof courseMap !== 'undefined');

      if (courseName) {
        if (typeof displayCourseDetails === 'function') {
          console.log('Calling displayCourseDetails...');
          displayCourseDetails();
        } else {
          console.error('displayCourseDetails function not found');
        }
        //console.log('Course: ' + courseName);
      } else {
        console.error('No course found in URL');
        //console.log('No course found');
      }
    };
  </script>
</body>

</html>