<!DOCTYPE html>
<html lang="en">
 
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Courserr</title>

  <!-- Favicon -->

  <!-- Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500;700&display=swap">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap">
  <!-- Material Symbols (for md-icon) -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp" />

  <!-- Material Web (md-icon, chips, etc.) -->
  <script type="importmap">
  {
    "imports": {
      "@material/web/": "https://esm.run/@material/web/"
    }
  }
  </script>
  <script type="module">
    import '@material/web/all.js';
    import {styles as typescaleStyles} from '@material/web/typography/md-typescale-styles.js';
    document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
  </script>

  <!-- Chart.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>

  <!-- Your JS files -->
  <script src="../Javascript/Class.js"></script>
  <script src="../Javascript/ClassInstantiation.js"></script>
  <script src="../Javascript/script.js"></script>
  <script src="../Javascript/loadClass.js"></script>


  <!-- Your CSS -->
  <link rel="stylesheet" href="../Style/style.css">
  <link rel="stylesheet" href="../Style/classPage2.css">
  <link rel="stylesheet" href="../Style/classColours.css">

  <!-- md-icon styling -->
  <style>
    md-icon {
      color: #006A6A;
      --md-icon-size: 48px;
    }
    md-icon.rounded {
      --md-icon-font: 'Material Symbols Rounded';
    }
    md-icon.sharp {
      --md-icon-font: 'Material Symbols Sharp';
    }
    md-icon.outlined {
      --md-icon-font: 'Material Symbols Outlined';
    }
    md-icon[filled] {
      font-variation-settings: 'FILL' 1;
    }
  </style>
</head>

<body class="classPage" style="background-color: var(--light-bg)" id="body">
    <div class="container" id="fullHeightDiv">
        <img src="../Images/menuIcon.png" class="menuMobile openMenu" id="lines" onclick="openClose(true)">
        <img src="../Images/closeIcon.png" class="menuMobile closeMenu" id="exes" onclick="openClose(false)">
        <span class="material-symbols-rounded mode" style="font-size:5vh" onclick="modeChange()">light_mode</span>
        <div class="sidebar" id="sidebar" style="background-color: var(--light-mode-bg)">
          <div class="sidebarItem mobileClose" onclick="openClose(false)" id="mobileClose" style="padding-left: calc(6vh + 1vw + 0.5vw)">
            Close
          </div>
          <div class="sidebarItem">
            <span class="material-symbols-rounded sidebar-icon" style="font-size:4vw" onclick="window.location.href = './index.html'";>flood</span>Home
          </div>
          <div class="sidebarItem">
            <span class="material-symbols-rounded sidebar-icon" style="font-size:4vw" onclick="window.open('../handbook.pdf')">menu_book</span>Handbook
          </div>
          <div class="sidebarItem" onclick="window.open('https://ameshighathletics.org/activities/?per_page=12&page=1', '_blank').focus();">
            <span class="material-symbols-rounded sidebar-icon" style="font-size:4vw">groups</span>Clubs & Activities
          </div>
          
          
        </div>
        <div class="main-content">
          <div class="header" style="background-color: var(--light-mode-bg);height: 10vh;" id="header">
                <div class="title"> 
                  <strong>Course<i>rr</i></strong>
                  <!--<button style="height: 10vh; width: 10vw">Click Me</button>-->
                </div>
        </div>
        
        
        
        </div>


        <div class="main-content-class-page">
        <div class="class-info-container" style="padding-top:12.5vh">
            <div class="class-page-header">
                <div class="class-page-header-left">
                    <div class="class-title-teacher-holder">

                        <h1 class="class-title" id="className">Loading...</h1>
                        <hr class="title-teacher-break">
                        <div class="class-teacher" id="teachers">Loading...</div>

                    </div>
                </div>
                <div class="class-page-header-right">

                    <div class="class-prerequisites" id="prereq">

                        <div class="elevated-rectangle-title">Prerequisites</div>
                    </div>

                    <div class="class-tags">
                      <div class="elevated-rectangle-title">Tags</div>
                        <div class="class-tags-holder">
                          <div class="elevated-rectangle-half">Reading Heavy</div>
                          <div class="elevated-rectangle-half">Extra Credit</div>
                          <div class="elevated-rectangle-half">Hard Tests</div>
                          <div class="elevated-rectangle-half">Fun</div>
                          <div class="elevated-rectangle-half">Engaging</div>
                        </div>
                    </div>

                    <div class="class-quick-info" id="quickHits">

                        <div class="elevated-rectangle-title">Quick Hits</div>

                    </div>

                </div>
            </div>

            <div class="class-page-half-box description classPageClassDecription" id="getColor">
              <p class="description-paragraph">Loading...</p>
            </div>

            <div class="class-page-half-box">
              <canvas id="myChart" class='classPageGraphHalf'></canvas>
            </div>

            <!-- AI Summary Box -->
            
        </div>





            <div class="class-comment-container" id="commentContainer">

              <div class="comment-header" id="commentHeader">
                <h1>Comments</h1>
              </div>
              <div class="area-with-the-comments">
              <div class="comment-box">
                <div class="comment-text"> 
                  <p>I really enjoyed this class because the material was interesting and our teacher, Ms. Johnson, made it engaging and fun to learn about. The workload can be pretty heavy at times, but I think it's worth it if you're interested in history like I am. My only suggestion would be to maybe have a few more group projects or discussions throughout the semester - sometimes we just sat through lectures for hours without much interaction. Overall though, I learned so much and appreciated the effort Ms. Johnson put into making this class enjoyable.</p>
                </div>
                <div class="review-info">
                  <div class="elevated-rectangle">Average Grade: A+</div>
                  <div class="elevated-rectangle">Time Spent: 2 hours / week</div>
                  <div class="elevated-rectangle">Difficulty: 3 / 5</div>
                </div>
                <!-- <div class="comment-tags-holder">
                  <div class="elevated-rectangle-half">Reading Heavy</div>
                          <div class="elevated-rectangle-half">Extra Credit</div>
                          <div class="elevated-rectangle-half">Hard Tests</div>
                          <div class="elevated-rectangle-half">Fun</div>
                          <div class="elevated-rectangle-half">Engaging</div>
                          <div class="elevated-rectangle-half">Extra Credit</div>
                          <div class="elevated-rectangle-half">Hard Tests</div>
                          <div class="elevated-rectangle-half">Fun</div>
                          <div class="elevated-rectangle-half">Engaging</div>
                </div> -->
                <div class="comment-kicker">
                  <!-- <md-icon-button>
                    <span class="material-symbols-rounded" id="likeBtn">thumb_up</span>
                  </md-icon-button>
                  <md-icon-button>
                    <span class="material-symbols-rounded" id="flagBtn">flag</span>
                  </md-icon-button> -->
                  <md-icon-button class="infoBtn">
                    <span class="material-symbols-rounded">info</span>
                  </md-icon-button>

                  

                </div>
              </div>

              <div class="comment-box">
                <div class="comment-text"> 
                  <p>I really enjoyed this class because the material was interesting and our teacher, Ms. Johnson, made it engaging and fun to learn about. The workload can be pretty heavy at times, but I think it's worth it if you're interested in history like I am. My only suggestion would be to maybe have a few more group projects or discussions throughout the semester - sometimes we just sat through lectures for hours without much interaction. Overall though, I learned so much and appreciated the effort Ms. Johnson put into making this class enjoyable.</p>
                </div>
                <div class="review-info">
                  <div class="elevated-rectangle">Average Grade: A+</div>
                  <div class="elevated-rectangle">Time Spent: 2 hours / week</div>
                  <div class="elevated-rectangle">Difficulty: 3 / 5</div>
                </div>
                <!-- <div class="comment-tags-holder">
                  <div class="elevated-rectangle-half">Reading Heavy</div>
                          <div class="elevated-rectangle-half">Extra Credit</div>
                          <div class="elevated-rectangle-half">Hard Tests</div>
                          <div class="elevated-rectangle-half">Fun</div>
                          <div class="elevated-rectangle-half">Engaging</div>
                          <div class="elevated-rectangle-half">Extra Credit</div>
                          <div class="elevated-rectangle-half">Hard Tests</div>
                          <div class="elevated-rectangle-half">Fun</div>
                          <div class="elevated-rectangle-half">Engaging</div>
                </div> -->
                <div class="comment-kicker">
                  <!-- <md-icon-button>
                    <span class="material-symbols-rounded" id="likeBtn">thumb_up</span>
                  </md-icon-button>
                  <md-icon-button>
                    <span class="material-symbols-rounded" id="flagBtn">flag</span>
                  </md-icon-button> -->
                  <md-icon-button class="infoBtn">
                    <span class="material-symbols-rounded">info</span>
                  </md-icon-button>

                  

                </div>
              </div>

              <div class="comment-box">
                <div class="comment-text"> 
                  <p>I really enjoyed this class because the material was interesting and our teacher, Ms. Johnson, made it engaging and fun to learn about. The workload can be pretty heavy at times, but I think it's worth it if you're interested in history like I am. My only suggestion would be to maybe have a few more group projects or discussions throughout the semester - sometimes we just sat through lectures for hours without much interaction. Overall though, I learned so much and appreciated the effort Ms. Johnson put into making this class enjoyable.</p>
                </div>
                <div class="review-info">
                  <div class="elevated-rectangle">Average Grade: A+</div>
                  <div class="elevated-rectangle">Time Spent: 2 hours / week</div>
                  <div class="elevated-rectangle">Difficulty: 3 / 5</div>
                </div>
                <!-- <div class="comment-tags-holder">
                  <div class="elevated-rectangle-half">Reading Heavy</div>
                          <div class="elevated-rectangle-half">Extra Credit</div>
                          <div class="elevated-rectangle-half">Hard Tests</div>
                          <div class="elevated-rectangle-half">Fun</div>
                          <div class="elevated-rectangle-half">Engaging</div>
                          <div class="elevated-rectangle-half">Extra Credit</div>
                          <div class="elevated-rectangle-half">Hard Tests</div>
                          <div class="elevated-rectangle-half">Fun</div>
                          <div class="elevated-rectangle-half">Engaging</div>
                </div> -->
                <div class="comment-kicker">
                  <!-- <md-icon-button>
                    <span class="material-symbols-rounded" id="likeBtn">thumb_up</span>
                  </md-icon-button>
                  <md-icon-button>
                    <span class="material-symbols-rounded" id="flagBtn">flag</span>
                  </md-icon-button> -->
                  <md-icon-button class="infoBtn">
                    <span class="material-symbols-rounded">info</span>
                  </md-icon-button>

                  

                </div>
              </div>
              </div>

            </div>
            </div>

       


        
</div>

<div class="dialoge-holder">
  <md-dialog id="infoDialog">
                    <div slot="content">These comments are submitted by students at Ames High School. They are anonymous and reviewed to ensure compliance with Ames Community School District policy. Their purpose is to give students a clear idea of what to expect in a class and to provide insights beyond a standard course description.</div>
                    <div slot="actions">
                      <md-text-button form="form-id" value="ok" id="closeBtn">Ok</md-text-button>
                    </div>
                  </md-dialog>
</div>
<script src="../Javascript/comments.js"></script>
<script src="../Javascript/loadClass.js"></script>

<script>
let course;
  window.onload = function() {
        console.log('JavaScript is running!');
        // Your onload logic
        const params = new URLSearchParams(window.location.search);
        let courseName = params.get('course');
        
        // If course parameter doesn't exist, try category parameter (for backward compatibility)
        if (!courseName) {
          courseName = params.get('category');
          if (courseName) {
            // Convert underscores back to spaces for category parameter
            courseName = courseName.replace(/_/g, ' ');
          }
        }
        
        console.log('Course name from URL: ' + courseName);
        console.log('displayCourseDetails function exists: ' + (typeof displayCourseDetails));
       console.log('courseMap exists: ' + (typeof courseMap !== 'undefined'));
        
        console.log('Course name from URL:', courseName);
        console.log('displayCourseDetails function exists:', typeof displayCourseDetails);
       console.log('courseMap exists:', typeof courseMap !== 'undefined');
        
        if (courseName) {
          if (typeof displayCourseDetails === 'function') {
           console.log('Calling displayCourseDetails...');
            displayCourseDetails();
          } else {
           console.error('displayCourseDetails function not found');
          }
            console.log('Course: ' + courseName);
        } else {
           console.error('No course found in URL');
            console.log('No course found');
        }
        makeCommentBackground();
    };

    function modeChange(thing) {
        console.log("darkmode");
        document.getElementsByTagName('style')[0].innerHTML="md-filter-chip { background-color: rgba(150, 150, 150, 0.5); --md-sys-color-outline:lightgrey;} .header {color: white;} .sidebar{color: white} .menuPic {filter: invert(100%)} .mode {filter: invert(100%)}";
          document.getElementById('body').style.backgroundColor = "var(--dark-bg)";
          document.getElementById('sidebar').style.backgroundColor = "var(--dark-mode-bg)";
          document.getElementById('header').style.backgroundColor = "var(--dark-mode-bg)";
      }

      
</script>
<script>
  const infoBtn = document.querySelectorAll('.infoBtn');
  const closeBtn = document.getElementById('closeBtn');
  const infoDialog = document.getElementById('infoDialog');

  for (let i = 0; i < infoBtn.length; i++) {
     infoBtn[i].addEventListener("click", () => {
      infoDialog.show();
     });
    }

  closeBtn.addEventListener('click', () => {
    infoDialog.close(); // opens the dialog
  });
</script>

<script>
// AI Summary Generation with Offline Fallback
document.addEventListener('DOMContentLoaded', function() {
    const generateBtn = document.getElementById('generateSummaryBtn');
    const summaryContent = document.getElementById('aiSummaryContent');
    const loadingDiv = document.getElementById('aiSummaryLoading');
    const modeIndicator = document.getElementById('aiModeIndicator');
    
    if (generateBtn) {
        generateBtn.addEventListener('click', generateAISummary);
    }
    
    // Check online/offline status
    function isOnline() {
        return navigator.onLine;
    }
    
    async function generateAISummary() {
        // Show loading state
        summaryContent.style.display = 'none';
        loadingDiv.style.display = 'flex';
        generateBtn.disabled = true;
        
        // Collect data from the page
        const courseData = collectCourseData();
        
        try {
            // Use offline fallback for now (can be enhanced with online models later)
            console.log('Using offline AI analysis');
            const summary = createAISummary(courseData);
            displaySummary(summary);
        } catch (error) {
            console.error('Error generating summary:', error);
            // Fallback to basic summary
            const summary = createBasicSummary(courseData);
            displaySummary(summary);
        }
    }
    
    function collectCourseData() {
        // Collect course information
        const courseName = document.getElementById('className')?.textContent || 'Unknown Course';
        const teacher = document.getElementById('teachers')?.textContent || 'Unknown Teacher';
        const description = document.querySelector('.description-paragraph')?.textContent || '';
        
        // Collect tags
        const tagElements = document.querySelectorAll('.class-tags-holder .elevated-rectangle-half');
        const tags = Array.from(tagElements).map(tag => tag.textContent.trim());
        
        // Collect comments from the dynamically loaded comments
        const commentElements = document.querySelectorAll('.comment-text p');
        const comments = Array.from(commentElements).map(comment => comment.textContent.trim());
        
        // Collect review info
        const reviewInfo = [];
        const reviewElements = document.querySelectorAll('.review-info .elevated-rectangle');
        reviewElements.forEach(review => {
            reviewInfo.push(review.textContent.trim());
        });
        
        return {
            courseName,
            teacher,
            description,
            tags,
            comments,
            reviewInfo
        };
    }
    
    // Enhanced offline AI analysis
    function createAISummary(data) {
        const { courseName, teacher, description, tags, comments, reviewInfo } = data;
        
        let summary = `ðŸ¤– **AI-Powered Course Analysis:**\n\n`;
        
        // Start with course description as the foundation
        if (description && description.trim()) {
            summary += `ðŸ“– **Course Description:**\n${description}\n\n`;
        }
        
        // Course overview with more detail
        summary += `ðŸ“š **Course Overview:**\n`;
        summary += `${courseName} is taught by ${teacher}. `;
        
        // Incorporate description into overview if not already shown
        if (!description || !description.trim()) {
            summary += `This course provides students with comprehensive learning opportunities. `;
        }
        
        // Tags analysis with more context
        if (tags.length > 0) {
            summary += `\n\nðŸ·ï¸ **Key Course Characteristics:**\n`;
            summary += `Based on student feedback, this course is characterized as: ${tags.join(', ')}. `;
            
            // Provide context for each tag
            if (tags.includes('Reading Heavy')) {
                summary += `Students should expect significant reading assignments and should develop strong reading comprehension skills. `;
            }
            if (tags.includes('Hard Tests')) {
                summary += `Assessments are challenging and require thorough preparation and understanding of course material. `;
            }
            if (tags.includes('Fun') || tags.includes('Engaging')) {
                summary += `The course content and teaching methods are designed to be engaging and enjoyable for students. `;
            }
            if (tags.includes('Extra Credit')) {
                summary += `Additional opportunities for academic improvement are available through extra credit assignments. `;
            }
        }
        
        // Enhanced comments analysis
        if (comments.length > 0) {
            summary += `\n\nðŸ’¬ **Student Feedback Analysis:**\n`;
            const positiveAspects = [];
            const challenges = [];
            const workloadNotes = [];
            
            comments.forEach(comment => {
                const lowerComment = comment.toLowerCase();
                if (lowerComment.includes('enjoy') || lowerComment.includes('fun') || lowerComment.includes('great') || lowerComment.includes('love')) {
                    positiveAspects.push('Students find the course engaging and enjoyable');
                }
                if (lowerComment.includes('heavy') || lowerComment.includes('difficult') || lowerComment.includes('challenging') || lowerComment.includes('hard')) {
                    challenges.push('Course workload can be demanding');
                }
                if (lowerComment.includes('workload') || lowerComment.includes('time') || lowerComment.includes('hours')) {
                    workloadNotes.push('Students mention workload considerations');
                }
            });
            
            if (positiveAspects.length > 0) {
                summary += `âœ… **Positive Aspects:** ${positiveAspects[0]}\n`;
            }
            if (challenges.length > 0) {
                summary += `âš ï¸ **Challenges:** ${challenges[0]}\n`;
            }
            if (workloadNotes.length > 0) {
                summary += `â° **Workload Considerations:** Students should plan their time accordingly\n`;
            }
        }
        
        // Review metrics with analysis
        if (reviewInfo.length > 0) {
            summary += `\n\nðŸ“Š **Student Performance Data:**\n`;
            reviewInfo.forEach(info => {
                summary += `â€¢ ${info}\n`;
            });
        }
        
        // Comprehensive recommendation based on all data
        summary += `\n\nðŸŽ¯ **Overall Assessment:**\n`;
        
        // Base recommendation on course description and tags
        if (description && description.toLowerCase().includes('advanced') || tags.includes('Hard Tests')) {
            summary += `This course appears to be academically rigorous and suitable for students seeking a challenging learning experience. `;
        } else if (tags.includes('Fun') || tags.includes('Engaging')) {
            summary += `This course offers an engaging learning environment that balances academic rigor with student enjoyment. `;
        } else {
            summary += `This course provides a solid academic foundation with opportunities for student growth and development. `;
        }
        
        // Add specific recommendations based on tags
        if (tags.includes('Reading Heavy')) {
            summary += `Students should develop strong reading habits and time management skills. `;
        }
        if (tags.includes('Hard Tests')) {
            summary += `Regular study and preparation are essential for success in this course. `;
        }
        if (tags.includes('Extra Credit')) {
            summary += `Students have opportunities to improve their grades through additional work. `;
        }
        
        summary += `Overall, this course offers a comprehensive learning experience that combines academic challenge with student support.`;
        
        return summary;
    }
    
    // Basic fallback summary
    function createBasicSummary(data) {
        const { courseName, teacher, description } = data;
        return `ðŸ“š **Course Summary:**\n\n${courseName} taught by ${teacher}.\n\n${description || 'No description available.'}`;
    }
    
    function displaySummary(summary) {
        // Hide loading and show summary
        loadingDiv.style.display = 'none';
        summaryContent.style.display = 'flex';
        
        // Create and display the summary
        const summaryDiv = document.createElement('div');
        summaryDiv.className = 'ai-summary-text';
        summaryDiv.innerHTML = summary.replace(/\n/g, '<br>');
        
        summaryContent.innerHTML = '';
        summaryContent.appendChild(summaryDiv);
        
        // Re-enable button
        generateBtn.disabled = false;
        generateBtn.innerHTML = `
            <span slot="icon" class="material-symbols-rounded">refresh</span>
            Regenerate Summary
        `;
    }
    
    // Update mode indicator
    function updateModeIndicator() {
        if (modeIndicator) {
            const icon = modeIndicator.querySelector('.mode-icon');
            const text = modeIndicator.querySelector('.mode-text');
            
            modeIndicator.className = 'ai-mode-indicator offline';
            icon.textContent = 'psychology';
            text.textContent = 'AI Analysis';
        }
    }
    
    // Initialize mode indicator
    updateModeIndicator();
});
</script>
</body>
</html>